<!DOCTYPE html>
<html>
<head>
    <title>Test models.dev Fetch</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #e0e0e0; }
        .success { color: #2ed573; }
        .error { color: #ff6b81; }
        pre { background: #2a2a2a; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Testing models.dev API Fetch</h1>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        output.innerHTML += '<p>Starting fetch...</p>';
        
        fetch('https://models.dev/api.json')
            .then(response => {
                output.innerHTML += `<p class="success">✓ Fetch succeeded, status: ${response.status}</p>`;
                return response.json();
            })
            .then(data => {
                output.innerHTML += '<p class="success">✓ JSON parsed successfully</p>';
                
                // Check structure
                output.innerHTML += `<p>Keys in data: ${Object.keys(data).slice(0, 10).join(', ')}</p>`;
                output.innerHTML += `<p>Has anthropic? ${('anthropic' in data) ? 'YES' : 'NO'}</p>`;
                output.innerHTML += `<p>Has openai? ${('openai' in data) ? 'YES' : 'NO'}</p>`;
                
                if (data.anthropic && data.anthropic.models) {
                    const models = data.anthropic.models;
                    output.innerHTML += `<p>Anthropic models object keys: ${Object.keys(models).length}</p>`;
                    
                    const modelArray = Object.values(models);
                    output.innerHTML += `<p>Total Anthropic models: ${modelArray.length}</p>`;
                    
                    const toolModels = modelArray.filter(m => m.tool_call === true);
                    output.innerHTML += `<p class="success">Anthropic models with tool_call=true: ${toolModels.length}</p>`;
                    
                    const modelIds = toolModels.map(m => m.id).sort();
                    output.innerHTML += '<p>Model IDs:</p><pre>' + JSON.stringify(modelIds, null, 2) + '</pre>';
                } else {
                    output.innerHTML += '<p class="error">✗ Anthropic models not found in expected structure</p>';
                    output.innerHTML += '<pre>' + JSON.stringify(data.anthropic, null, 2).substring(0, 500) + '</pre>';
                }
            })
            .catch(error => {
                output.innerHTML += `<p class="error">✗ Error: ${error.message}</p>`;
                console.error('Full error:', error);
            });
    </script>
</body>
</html>
